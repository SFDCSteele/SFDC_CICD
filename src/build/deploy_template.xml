<project name="VA full deploy build.xml"  basedir="." xmlns:sf="antlib:com.salesforce" xmlns:ac="antlib:net.sf.antcontrib">

	<property file="build.properties"/>
	<property environment="env"/>
	<property name="work.envName" value="" />
	<property name="work.serverurl" value="" />
	<property name="work.username" value="" />
	<property name="work.password" value="" />
	<property name="work.deploy.location" value="${sf.deploy.location}" />
	<property name="work.deploy.check.location" value="${sf.deploy.check.location}" />
	<property name="work.repo.location" value="${sf.repo.location}" />
	<property name="work.unpackaged" value="" />
	<property name="work.branch" value="" />
	<property name="work.packageNames" value="" />

	<taskdef resource="com/salesforce/antlib.xml" uri="antlib:com.salesforce">
		<classpath>
			<!--pathelement location="/Users/wsteele/vawork/salesforce_ant_41.0/ant-salesforce.jar" /-->
			<pathelement location="/Users/williamsteele/icloud/salesforce/va/vawork/salesforce_ant_41.0/ant-salesforce.jar" />
		</classpath>
	</taskdef>
	<!-- taskdef uri="antlib:net.sf.antcontrib"
		resource="net/sf/antcontrib/antlib.xml"
		classpath="/users/williamsteele/Documents/workspace/apache-ant-1.10.1/bin/lib/ant-contrib-1.0b3.jar">
	</taskdef -->
	<taskdef resource="net/sf/antcontrib/antlib.xml">
		<classpath>
			<!--pathelement location="/Users/wsteele/vawork/salesforce_ant_41.0/lib/ant-contrib-1.0b3.jar"/-->
			<pathelement location="/Users/williamsteele/icloud/salesforce/va/vawork/salesforce_ant_41.0/lib/ant-contrib-1.0b3.jar"/>
		</classpath>
	</taskdef>

	<target name="execute-deploy" >
		<echo message="###################################################################################################"/>
		<echo message="Performing a Full deploy (Check=${check}) of ${work.deploy.location}/src to ${work.serverurl}..." />
		<echo message="###################################################################################################"/>
		<echo message="Performing copy of ${work.unpackaged} from ./src/build/Releases/${sf.release_branch}/${work.unpackaged} to ./src"/>
		<copy file="./src/build/Releases/${sf.release_branch}/${work.unpackaged}"
			tofile="./src/package.xml" overwrite="true" failonerror="true"/>
		<echo message="###################################################################################################"/>
		<delete file="${zip.deploy.location}/full_deploy.zip"/>

		<zip destfile="${zip.deploy.location}/full_deploy.zip">
	        <zipfileset dir="./src">
<!-- INSERT FILES HERE -->
				<include name="package.xml"/>
	        </zipfileset>
	    </zip>
		<sf:deploy
			username="${work.username}"
			password="${work.password}"
			serverurl="${work.serverurl}"
			maxPoll="${sf.maxPoll}"
			pollWaitMillis="${sf.pollWaitMillis}"
			singlePackage="true"
			ignoreWarnings="true"
			zipFile="${zip.deploy.location}/full_deploy.zip"
			allowMissingFiles="true"	
			rollbackOnError="true"
<!-- INSERT CLASSES HERE -->
		</sf:deploy>

	</target>


</project>
